```
SELECT
    e.expedition_id,
    e.destination,
    e.status,
    (
        SELECT ROUND(
            SUM(
                CASE WHEN
                    em.survived 
                THEN 1 
                ELSE 0
                END
                ) * 100.00 / NULLIF(COUNT(em.dwarf_id), 0)
        , 2)
        FROM 
            EXPEDITION_MEMBERS em
        WHERE
            em.expedition_id = e.expedition_id
    ) AS survival_rate,
    (
        SELECT SUM(ea.value) 
        FROM EXPEDITION_ARTIFACTS ea
        WHERE ea.expedition_id = e.expedition_id
    ) AS artifacts_value,
    (
        SELECT COUNT(ea.site_id)
        FROM EXPEDITION_SITES es
        WHERE es.expedition_id = e.expedition_id
    ) AS discovered_sites,
    (
        SELECT ROUND(
            SUM(
                CASE WHEN
                    ec.outcome = 'SUCCESS'
                THEN 1
                ELSE 0
                END
            ) * 100.0 / NULLIF(COUNT(*), 0)
        , 2)
        FROM EXPEDITION_CREATURES ec
        WHERE ec.expedition_id = e.expedition_id
    ) AS encounter_success_rate,
    (
        SELECT 
            SUM(
                CASE WHEN
                    ds.date >= e.departure_date
                THEN ds.level
                END
            ) - SUM(
                CASE WHEN
                    ds.date < e.departure_date
                THEN ds.level
                END
            )
        FROM 
            DWARF_SKILLS ds
        INNER JOIN
            EXPEDITION_MEMBERS em
        ON
            ds.dwarf_id = em.dwarf_id
        WHERE
            em.expedition_id = e.expedition_id
    ) AS skill_improvement,
    DATEDIFF(
        day, e.departure_date, e.return_date
    ) AS expedition_duration,
    (
        (
            survival_rate + 
            (
                artifacts_value * 100 / (
                    SELECT SUM(ea.value)
                    FROM EXPEDITION_ARTIFACTS ea
                    WHERE ea.expedition_id IS NOT NULL
                )
            ) + (
                discovered_sites * 100 / (
                    SELECT COUNT(site_id)
                    FROM EXPEDITION_SITES es
                    WHERE es.expedition_id IS NOT NULL
                )
            ) + (
                encounter_success_rate * 100 / (
                    SELECT COUNT(creature_id)
                    FROM EXPEDITION_CREATURES ec
                    WHERE ec.expedition_id IS NOT NULL
                )
            ) + (
                skill_improvement * 100 / (
                    SELECT COUNT(skill_id)
                    FROM DWARF_SKILLS ds
                    WHERE ds.date >= e.departure_date
                )
            )
        ) / 5.0
    ) AS overall_success_score,
    JSON_OBJECT(
        'member_ids', (
            SELECT JSON_ARRAYAGG(em.dwarf_id)
            FROM EXPEDITION_MEMBERS em
            WHERE em.expedition_id = e.expedition_id
        ),
        'artifact_ids', (
            SELECT JSON_ARRAYAGG(ea.artifact_id)
            FROM EXPEDITION_ARTIFACTS ea
            WHERE ea.expedition_id = e.expedition_id
        ),
        'site_ids', (
            SELECT JSON_ARRAYAGG(es.site_id)
            FROM EXPEDITION_SITES es
            WHERE es.expedition_id = e.expedition_id
        )
    ) AS related_entities    
     
FROM
    EXPEDITIONS e
ORDER BY
    overall_success_score DESC
```