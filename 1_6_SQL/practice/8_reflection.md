Не до конца правильно понял задание.
В своем решении искал сводные данные по каждой крепости. Однако судя по рекомендуемому решению нужно было делать именно комплексный анализ данных всех крепостей.
В целом так и написано в условии, смутила только фраза "Комплексный анализ торговых отношений **_и их влияния на крепость_**"

Это пока что самое сложное из заданий. Очень много времени потратил на проектирование запроса и выявление/построение нужных связей.
Написал себе шпаргалку, как подходить к решению таких задач:

``` 
Перевести и понять все поля из ожидаемого результата.

Выделить основную связующую единицу - первичный ключ в результирующей выборке.

Составить схему связей для ответа "от общего к частному". Можно начать с первого ключа данных в требуемом ответе.

Писать код запроса.
```

Подобные задания поначалу пугают своей масштабностью и непониманием как к ним подступиться.
Алгоритм действий, который я привел выше помог мне сдвинуться с "мертвой точки".

Хочу выделить немного времени от последующих заданий, чтобы закончить свой второй вариант уже корректного решения этой задачи.