Главный прием который я запомнил из этого задания - как корректно работать с группировками.
Например, для расчета времени производства мастерской не требуется явно вычислять для каждой мастерской дату начала и конца. 
Достаточно выполнить JOIN с таблицей, хранящей данные о времени, связав по workshop_id и выполнить группировку. 
Далее из MAX(data) вычесть MIN(data). 
Раньше я бы костылил подзапросы, CTE или более сложные конструкции для таких вычислений. 


Анализируя предлагаемое решение понимаю что не до конца корректно понял смысл некоторых полей в базе. 
Например, я считал что для получения значения active_production_days не достаточно посчитать количество wp.production_date.
Допускал ситуацию, когда для производства единицы какого то продукта необходимо несколько дней. 
В таком случае подсчет только дней выпуска (production_date) был бы некорректен.
Поэтому я использовал варианты построения последовательностей (GENERATE_SERIES) для получения дней, когда в мастерской велись работы.


В целом кажется предлагаемый вариант решения гораздо более простой чем тот, который реализовал я.
Многие метрики в предлагаемом решении удалось вычислить гораздо более простым путем.


Хочу отметить одну свою проблему при решении. 
Некоторое время потратил на анализ того, какие именно вычисления выносить в СТЕ и как в СТЕ их корректно связать.
Например, у меня полчислись следующие СТЕ по смыслу:
- Статистика по мастерским
- Скилы дворфов по мастерским
- Рабочие дворфо-дни
- Дни работы мастерских

В свою очередь предлагаемое решение использует такие СТЕ:
- Статистика по мастерским
- Продуктивность дворфов
- Скилы дворфов по мастреским/дворфам
- Эффективность использования материалов

Мне пока трудно объективно оценить какое использование СТЕ было более "правильным".
