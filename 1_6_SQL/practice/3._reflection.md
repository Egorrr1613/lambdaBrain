Разобрал предлагаемое решение, использующее подзапросы. 
Разобрался, как можно отдавать в результирующую выборку данные типа JSON.
Разобрал функции JSON_OBJECT, JSON_ARRAYAGG, JSON_OBJECTAGG.

Попробовал написать самостоятельно запрос для получения тех же данных - результат получился почти идентичным предлагаемому решению.