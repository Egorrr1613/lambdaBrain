Мое решение получилось реализованно "в лоб". Старался делать по аналогии с предыдущими заданиями.

Постарался понять логику эталонного решения в части того, какие вычисления выносились в СТЕ. 

Все новые ключевых слова из эталонного решения мне знакомы. Часть использовал в своем решении.

Главный минус моего решения - дублирующийся код. 
Специально не использовал в своем решении СТЕ, так как ранее в эталонных решениях такая конструкция не встречалась.

В дальнейшем буду тщательнее планировать реализацию, учитывая возможность вынесения части общих вычислений в СТЕ.