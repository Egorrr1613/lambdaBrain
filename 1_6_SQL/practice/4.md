Задача 2: Получение данных о гноме с навыками и назначениями

```
SELECT
    d.dwarf_id,
    d.name,
    d.age,
    d.profession,
    JSON_OBJECT(
        'skill_ids', (
            SELECT JSON_ARRAYAGG(ds.skill_id)
            FROM DWARF_SKILLS ds
            WHERE ds.dwarf_id = d.dwarf_id
        ),
        'assignment_ids', (
            SELECT JSON_ARRAYAGG(da.assignment_id)
            FROM DWARF_ASSIGNMENTS da
            WHERE da.dwarf_id = d.dwarf_id
        ),
        'squad_ids', (
            SELECT JSON_ARRAYAGG(sm.squad_id)
            FROM SQUAD_MEMBERS sm
            WHERE sm.dwarf_id = d.dwarf_id
        ),
        'equipment_ids', (
            SELECT JSON_ARRAYAGG(de.equipment_id)
            FROM DWARF_EQUIPMENT de
            WHERE de.dwarf_id = d.dwarf_id
        )
    ) AS related_entities
FROM
    DWARVES d;
```

Задача 3: Данные о мастерской с назначенными рабочими и проектами

```
SELECT
    w.workshop_id,
    w.name,
    w.type,
    w.quality,
    JSON_OBJECT(
        'craftsdwarf_ids', (
            SELECT JSON_ARRAYAGG(w_c.dwarf_id)
            FROM WORKSHOP_CRAFTSDWARVES w_c
            WHERE w_c.workshop_id = w.workshop_id
        ),
        'project_ids', (
            SELECT JSON_ARRAYAGG(p.project_id)
            FROM PROJECTS p
            WHERE p.workshop_id = w.workshop_id
        ),
        'input_material_ids', (
            SELECT JSON_ARRAYAGG(w_m.material_id)
            FROM WORKSHOP_MATERIALS w_m
            WHERE w_m.workshop_id = w.workshop_id
        ),
        'output_product_ids', (
            SELECT JSON_ARRAYAGG(w_p.product_id)
            FROM WORKSHOP_PRODUCTS w_p
            WHERE w_p.workshop_id = w.workshop_id
        )
    ) AS related_entities
FROM
    WORKSHOPS w;
```

Задача 4: Данные о военном отряде с составом и операциями

``` 
SELECT
    m_s.squad_id,
    m_s.name,
    m_s.formation_type,
    m_s.leader_id,
    JSON_OBJECT(
        'member_ids', (
            SELECT JSON_ARRAYAGG(s_m.dwarf_id)
            FROM SQUAD_MEMBERS s_m
            WHERE m_s.squad_id = s_m.squad_id
        ),
        'equipment_ids', (
            SELECT JSON_ARRAYAGG(s_e.equipment_id)
            FROM SQUAD_EQUIPMENT s_e
            WHERE s_e.squad_id = m_s.squad_id
        ),
        'operation_ids', (
            SELECT JSON_ARRAYAGG(s_o.operation_id)
            FROM SQUAD_OPERATIONS s_o
            WHERE s_o.squad_id = m_s.squad_id
        ),
        'training_schedule_ids', (
            SELECT JSON_ARRAYAGG(s_t.schedule_id)
            FROM SQUAD_TRAINING s_t
            WHERE s_t.squad_id = m_s.squad_id
        ),
        'battle_report_ids', (
            SELECT JSON_ARRAYAGG(s_b.report_id)
            FROM SQUAD_BATTLES s_b
            WHERE s_b.squad_id = m_s.squad_id
        )
    ) AS related_entities
FROM
    MILITARY_SQUADS m_s
```